from django.contrib.auth.models import Permission, User
from django.db import models
from .validate import validate_file_extension






class File(models.Model):
    file = models.FileField(upload_to="Files", validators=[validate_file_extension])

    def __int__(self):
        return self.file.name


class cvemapping(models.Model):
    STATE_TYPES = (
        (0, 'Protecode'),
        (1, 'Blackduck'),
        (2, 'Text File'),
        (3, 'Single CVE Search'),

     )

    Choices_TYPES = (
        (1, 'ExploitDB'),
        (2, 'NMAP'),
        (3, 'Both'),
     )

    user = models.ForeignKey(User, default=1)
    artist = models.IntegerField(choices=STATE_TYPES, null=True)
    cvemapping_logo = models.FileField()
    update_check = models.BooleanField(default=False)
    choice = models.IntegerField(choices=Choices_TYPES, null=True)
    val1 = models.CharField(max_length=100) 
    val2 = models.CharField(max_length=100)
    val3=models.CharField(max_length=100)
    val4=models.CharField(max_length=100)
    val1 = "null"
    val2 = "null"
    val3 = "null"
    val4 = "null"

def __int__(self):
        return self.cvemapping_title + ' - ' + self.artist

